shared 데이터에 두개 프로세스 동시에 하면
이상해 질 수 도!!

ppt 기준 2페이지

balance = balance - amount; 에서 인터룹트
put해야 잔액에 들어가는데 그 전에 인투릅트 데서 꽁돈 생긴 상황

3페이지
=> race condition 발생.
=> 어떤 특정 타이밍에, 발생 (undeterministic!!!) <항상 발생 x, 이거 고려해서 프로그램 만들어야함.>

4페이지
동기화 문제 해결법 필요.
-> critical section 문제에 대한 해결..!

5페이지 -> 실습하려는 코드!

프로듀서는 N이면(꽉찼으면) 무한루프
컨슈머는 0이면( 비어있으면) 무한루프

count가 지금 공유 변수(shared data)

6페이지
잘안되는거 보여줌.

지금 문제
1. while -> cpu 사용하면서 기다림 (비지웨이트)
2. count 보호 안해줌. -> 동기화 문제

7페이지
멀티 스레드, 멀티 프로세스 버전 둘다 할것(오늘은 스레드로)

8페이지..
스핀락 = 비지웨이팅 (cpu 사용 낭비), 인터룹트 disable을 app이 해도 되겠냐..;; 그러면 안되지..

app 수준에서 이런거 방지 필요 => 세마포어, 뮤텍스. 필요 => 
근데 프로그래머가 잘 못 짜더라.. => 런타임에 알아서 잘 해주게 하자 => 모니터.. => 근데 이거는 자바만 지원... function 앞에 싱크로나이제이션 써야댐..

9페이지..
세마포어란..... 그냥 인티져 변수 ... shared data의 개수...
세마포어에 행해지는 오퍼레이션 2가지 ... +1, -1 (wait, signal)

0이얌 => wait => 왔넹 => -1 //  P
다썼어 => signal => +1 // V

10페이지..
요번시간엔 POSIX 세마포어.. SYSTEM 5는 프로세스간에.. 프로세스는 다음 시간에...

11페이지

init = 세마포어 초기화
wait = wait, -1 기다림.
try_wait = 쓸수 없어.. fail..!!! 폴링 ..?
destroy = 다쓰고 없애용..!

뮤텍스락이든 세마포어든 쓰기..?

18페이지
empty는 비지웨이트 막아줌

full 데이터가 들어가있는 공간 개수..
비어있는 공간 개수.. empty

데이터가 빈공간 = 처음 N개

결론 뮤텍스는 lock을 위한 세마포어고
나머지는 데이터에 대한 세마포어

==========
데드락 부분
hold and wait (2개 가지려함)
21p
모두 다 두번째 웨이트에서 기다림. 모두다 1개씩 가져서.. 이런 상황 안나오게 한다.
둘다 쓸수 있을때 둘을 동시에 드는 컨셉

젓가락 5개를 세마포어와 내가 밥을 먹을수 있다 없다라는 상태 세마포어가 있다.
test로 내가 집을 수 잇는지 상태 확인.

-> 하지만 데드락은 면해도 스타베이션은 아직 남아있다.

1,2 다 스레드로 했음.
-> 프로세스는 fork로 5개+시스템 5 세마포어
시험문제는 쓰레드 버전을 프로세스 버전으로 바꾸기 등등.

==========
세마포어 또는 lock 사용
